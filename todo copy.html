<!DOCTYPE html>
<html lang=ja>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>todolist</title>
    </head>
    <body>

        <input type="text" id="input_message" value="">
        <ul id=output_message>
            <!-- モックアップ -->
            <!-- <li id="testli"><input type="checkbox"><span class="line">todo</span><button id="btn">削除</button></li> -->
            <!-- モックアップ -->
        </ul>

        <style>
            .line{text-decoration: line-through;};

        </style>
        <script type="text/javascript">
            let im = document.getElementById("input_message");
            let isComposing = false;
            im.addEventListener('keydown',event => {
                if (im.value == ""){
                    return
                }
                if (!isComposing && event.keyCode === 13){
                    let li = document.createElement("li");
                    let bu = document.createElement("button");
                    let ch = document.createElement("input")
                    let sp = document.createElement("span")
                    ch.setAttribute("type","checkbox");
                    let ul = document.getElementById("output_message");
                    let input = document.getElementById("input_message");
                    ul.appendChild(li);
                    sp.textContent = im.value
                    im.value = ""
                    li.appendChild(ch);
                    li.appendChild(sp);
                    li.appendChild(bu);
                    bu.innerText = "削除";
                    bu.addEventListener('click',()=>{
                        bu.parentElement.remove()
                    })
                    ch.addEventListener('change',()=>{
                        if (ch.checked === true){
                            sp.classList.add("line");
                        }
                        else {
                            sp.classList.remove("line");
                        }
                        // console.log(ch.checked); // 選択されたらtrue、選択解除はfalse
                    });
                }
            
            });
            im.addEventListener('compositionstart', function(event) {
                isComposing = true;
            });
            im.addEventListener('compositionend', function(event) {
                isComposing = false;
            });

// インデントがズレている。タグに同一idを付与することはできない。

        </script>
    </body>
</html>